---
title: "Statistical Inference Course Project - Exponential Distribution and the CLT"
author: "Felix Lopez"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


## Introduction

In this project I investigate the exponential distribution and compare it with the Central Limit Theorem (CLT). An exponential distribution is a probability distribution that describes the time between events in a Poisson process. It deals with continuous variables. The distribution is positively skewed to the right. I will set lambda to 0.2 for all of the simulations. Doing this, I investigate the distribution of averages of 40 exponentials and perform a thousand simulations. In the second part of this work I analyse the potential effect of dose of vitamin C and two different supplements in tooth growth. 

## Simulation

```{r, include=FALSE}
set.seed(123)
lambda <- 0.2
n <- 40
simulations <- 1000
```

### Simulating Exponential Distribution

Now I calculate  the means of 40 exponentials for each of the 1000 exponential simulations.

```{r}
# Simulate 1000 averages of 40 exponentials
simulated_means <- replicate(simulations, mean(rexp(n, lambda)))

# Theoretical mean and standard deviation
theoretical_mean <- 1 / lambda
theoretical_sd <- 1 / lambda / sqrt(n)

# Sample mean and standard deviation
sample_mean <- mean(simulated_means)
sample_sd <- sd(simulated_means)
```


Here are the results of the theoretical and sample statistics (mean and standard deviations). 

```{r, results}
# Results

sample_mean
theoretical_mean
sample_sd
theoretical_sd
```


#### Comparing Sample Mean to Theoretical Mean

The sample mean of the simulated data is `r sample_mean`, while the theoretical mean is `r theoretical_mean`. As we can see, the sample mean is very close to the theoretical mean. The same happens with the standar deviation. The theoretical SD is `r theoretical_sd`and the sample SD is `r sample_sd`. Very close. This is expected due to the Law of Large Numbers. The Law states that as the number of trials of a random experiment increases, the average of the results obtained from those trials will converge to the expected value. It means that the more times you repeat an experiment, the closer the average of the outcomes will be to the theoretical probability or expected value.



### Comparing Sample Variance to Theoretical Variance

The theoretical variance of the mean of 40 exponentials is ( \frac{(\frac{1}{\lambda})^2}{n} ).


```{r, theoretical variance}
# Calculating the theoretical variance of a distribution (lambda is the parameter and n is the sample size).
# The formula computes the variance base on these parameters.
theoretical_variance <- (1 / lambda)^2 / n

#This line calculates the sample variance of the simulated_means data. Var is a function that computes the variance of the given data. 
sample_variance <- var(simulated_means)

#Cat is a function that concatenates and print the values. 

cat("Theoretical Variance:", theoretical_variance, "\n")
cat("Sample Variance:", sample_variance, "\n")
``` 
Again, we would expect a sample variance close to the theoretical variance. In fact, the sample variance is `r sample_variance` and the theoretical variance is `r theoretical_variance`. 


### Approximate Normality

The histogram of the sample means (below) resemble a normal distribution, demonstrating the Central Limit Theorem. The red curve in the histogram represents the normal distribution with the same mean and variance. The histogram of these 1000 sample means look more Gaussian because, according to the CLT, the distribution of the sample means will tend to be normal, even if the original data is not. The more samples we take and the larger the size of each sample, the closer the distribution of the sample means will be to a normal distribution.

```{r}
library(ggplot2)

# Combine histogram and normal distribution
ggplot(data.frame(x=simulated_means), aes(x=x)) +
  geom_histogram(aes(y=after_stat(density)), bins=30, fill="darkblue", alpha=0.5) +
  stat_function(fun=dnorm, args=list(mean=mean(simulated_means), sd=sd(simulated_means)), 
                color="red", linewidth=0.5) +
  labs(title="Distribution of Sample Means", x="Sample Means", y="Density")
```


## Part 2: Basic Inferential Data Analysis Instructions

This dataset is about "response is the length of odontoblasts (cells responsible for tooth growth) in 60 guinea pigs. Each animal received one of three dose levels of vitamin C (0.5, 1, and 2 mg/day) by one of two delivery methods, orange juice or ascorbic acid (a form of vitamin C and coded as VC)."

In this section I will analyse this dataset and the difference of dosis and supplements on toothgrowth. 


Loading and providing a basic summary of the dataset. 

```{r}
library(datasets)
data("ToothGrowth")
str(ToothGrowth)
head(ToothGrowth)
summary(ToothGrowth)
```

Using boxplots to check tooth growth as a function of dose.

```{r}
ToothGrowth$dose <- as.factor(ToothGrowth$dose)
ggplot(aes(x=dose, y=len), data=ToothGrowth) + geom_boxplot(aes(fill=dose))
```


It seems dose has a strong effect in growth. 
Let's, then, use confidence intervals and hypothesis test to compare tooth growth by dose. To do so I will subset dosis in three groups.

```{r}
#Create three sub-groups per dose level pairs in order to check for group differences.
ToothGrowth.doses_0.5_1.0 <- subset(ToothGrowth, dose %in% c(0.5, 1.0))
ToothGrowth.doses_0.5_2.0 <- subset(ToothGrowth, dose %in% c(0.5, 2.0))
ToothGrowth.doses_1.0_2.0 <- subset(ToothGrowth, dose %in% c(1.0, 2.0))
```
Check for group differences due to different dose levels of (0.5, 1.0). Assume unequal variances between the two groups.

```{r}
t.test(len ~ dose, data = ToothGrowth.doses_0.5_1.0)

```


Check for group differences due to different dose levels of (0.5, 2.0). Assume unequal variances between the two groups.

```{r}
ttest1 <- t.test(len ~ dose, data = ToothGrowth.doses_0.5_2.0)
print(ttest1, options=999)
```



Check for group differences due to different dose levels of (1.0, 2.0). Assume unequal variances between the two groups.

```{r}
t.test(len ~ dose, data = ToothGrowth.doses_1.0_2.0)
```

For all three t-tests, the p-values are way less than 0.05, and the confidence intervals do not include zero. Therefore, we reject the null hypothesis and conclude that increasing the dose level results in greater tooth length.



Now lets see tooth growth as a function of supplement type. 

```{r}
ggplot(aes(x=supp, y=len), data=ToothGrowth) + geom_boxplot(aes(fill=supp))
```


Using confidence intervals and hypothesis test to compare the effect of supp on length. Assume unequal variances between the two groups.

```{r}
t.test(len ~ supp, data = ToothGrowth)
```
As we see above, that the p-value is equal to 0.06 and the confidence interval contains zero. Thus, we fail to reject the null hypothesis that the different supplement types have no effect on tooth length.


## Stating my conclusions, based on my assumptions

Supplement type has no effect on tooth growth. Increasing the dose level leads to increased tooth growth.
The experiment involved randomly assigning guinea pigs to different dose levels and supplement types to control for potential confounding variables that could influence the results. The 60 guinea pigs in the sample are considered representative of the entire population of guinea pigs, allowing for the generalization of the findings. For the t-tests, it is assumed that the variances of the two groups being compared are different. This assumption is less stringent than assuming equal variances between the groups.


